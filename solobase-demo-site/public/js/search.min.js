class DocsSearch{constructor(){this.searchInput=document.getElementById("docs-search"),this.searchResults=document.getElementById("search-results"),this.searchIndex=null,this.searchData=[],this.isInitialized=!1,this.searchInput&&this.init()}async init(){try{const e=await fetch("/docs/index.json");this.searchData=await e.json(),this.searchIndex=lunr(function(){this.ref("id"),this.field("title",{boost:10}),this.field("description",{boost:5}),this.field("content"),this.field("tags",{boost:3}),this.searchData.forEach(e=>{this.add(e)})}.bind(this)),this.isInitialized=!0,this.bindEvents()}catch(e){console.error("Failed to initialize search:",e)}}bindEvents(){let e;this.searchInput.addEventListener("input",t=>{clearTimeout(e);const n=t.target.value.trim();if(n.length<2){this.hideResults();return}e=setTimeout(()=>{this.performSearch(n)},300)}),document.addEventListener("click",e=>{!this.searchInput.contains(e.target)&&!this.searchResults.contains(e.target)&&this.hideResults()}),this.searchInput.addEventListener("keydown",e=>{e.key==="Escape"?(this.hideResults(),this.searchInput.blur()):e.key==="ArrowDown"?(e.preventDefault(),this.navigateResults("down")):e.key==="ArrowUp"?(e.preventDefault(),this.navigateResults("up")):e.key==="Enter"&&(e.preventDefault(),this.selectResult())})}performSearch(e){if(!this.isInitialized)return;try{const t=this.searchIndex.search(e),n=t.slice(0,8).map(e=>{const t=this.searchData.find(t=>t.id===e.ref);return{...t,score:e.score,matchData:e.matchData}});this.displayResults(n,e)}catch(e){console.error("Search error:",e),this.displayError()}}displayResults(e,t){if(e.length===0){this.displayNoResults(t);return}const n=e.map(e=>{const o=this.highlightText(e.title,t),n=this.highlightText(e.description||"",t),s=this.createExcerpt(e.content,t);return`
        <div class="search-result-item p-3 hover:bg-gray-50 border-b border-gray-100 cursor-pointer" data-url="${e.url}">
          <div class="flex items-start justify-between">
            <div class="flex-1">
              <h4 class="text-sm font-semibold text-gray-900 mb-1">${o}</h4>
              ${n?`<p class="text-xs text-gray-600 mb-2">${n}</p>`:""}
              ${s?`<p class="text-xs text-gray-500">${s}</p>`:""}
              <div class="flex items-center mt-2 text-xs text-gray-400">
                <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
                <span>${this.formatUrl(e.url)}</span>
              </div>
            </div>
            <div class="ml-2 flex-shrink-0">
              <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
              </svg>
            </div>
          </div>
        </div>
      `}).join("");this.searchResults.innerHTML=`
      <div class="search-results-header p-3 bg-gray-50 border-b border-gray-200">
        <div class="flex items-center justify-between">
          <span class="text-sm text-gray-600">${e.length} result${e.length!==1?"s":""} for "${t}"</span>
          <button class="text-xs text-gray-500 hover:text-gray-700" onclick="document.getElementById('docs-search').value = ''; this.closest('.search-results').classList.add('hidden');">
            Clear
          </button>
        </div>
      </div>
      ${n}
      <div class="search-results-footer p-2 bg-gray-50 border-t border-gray-200">
        <div class="text-xs text-gray-500 text-center">
          Use ↑↓ to navigate, Enter to select, Esc to close
        </div>
      </div>
    `,this.showResults(),this.bindResultEvents()}displayNoResults(e){this.searchResults.innerHTML=`
      <div class="p-4 text-center">
        <svg class="w-8 h-8 mx-auto text-gray-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
        </svg>
        <p class="text-sm text-gray-600 mb-2">No results found for "${e}"</p>
        <p class="text-xs text-gray-500">Try different keywords or check spelling</p>
      </div>
    `,this.showResults()}displayError(){this.searchResults.innerHTML=`
      <div class="p-4 text-center">
        <svg class="w-8 h-8 mx-auto text-red-400 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <p class="text-sm text-gray-600">Search temporarily unavailable</p>
      </div>
    `,this.showResults()}bindResultEvents(){const e=this.searchResults.querySelectorAll(".search-result-item");e.forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.url;t&&(window.location.href=t)})})}navigateResults(e){const t=this.searchResults.querySelectorAll(".search-result-item");if(t.length===0)return;const s=this.searchResults.querySelector(".search-result-item.active");let n=0;if(s){s.classList.remove("active");const o=Array.from(t).indexOf(s);e==="down"?n=(o+1)%t.length:n=o===0?t.length-1:o-1}t[n].classList.add("active"),t[n].scrollIntoView({block:"nearest"})}selectResult(){const e=this.searchResults.querySelector(".search-result-item.active");if(e)e.click();else{const e=this.searchResults.querySelector(".search-result-item");e&&e.click()}}highlightText(e,t){if(!e||!t)return e;const n=new RegExp(`(${this.escapeRegex(t)})`,"gi");return e.replace(n,'<mark class="bg-yellow-200 px-1 rounded">$1</mark>')}createExcerpt(e,t,n=150){if(!e||!t)return"";const o=e.toLowerCase().indexOf(t.toLowerCase());if(o===-1)return e.substring(0,n)+(e.length>n?"...":"");const i=Math.max(0,o-50),a=Math.min(e.length,o+t.length+100);let s=e.substring(i,a);return i>0&&(s="..."+s),a<e.length&&(s=s+"..."),this.highlightText(s,t)}formatUrl(e){return e.replace("/docs/","").replace(/\/$/,"")||"Documentation"}escapeRegex(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}showResults(){this.searchResults.classList.remove("hidden")}hideResults(){this.searchResults.classList.add("hidden")}}document.addEventListener("DOMContentLoaded",()=>{if(typeof lunr=="undefined"){const e=document.createElement("script");e.src="https://unpkg.com/lunr@2.3.9/lunr.min.js",e.onload=()=>{new DocsSearch},document.head.appendChild(e)}else new DocsSearch});const searchStyles=`
  .search-result-item.active {
    background-color: #f3f4f6;
  }
  
  .search-result-item:hover {
    background-color: #f9fafb;
  }
  
  mark {
    background-color: #fef3c7;
    padding: 0 2px;
    border-radius: 2px;
  }
`,styleSheet=document.createElement("style");styleSheet.textContent=searchStyles,document.head.appendChild(styleSheet)